document.addEventListener("DOMContentLoaded", () => {
  const products = [
  // Комбинезоны
  {
    id: 1,
    title: "Комбинезон Каспер 20 г/м",
    description: "Костюм защитный одноразовый Каспер из ткани спанбонд для мужчин и женщин, для защиты одежды от загрязнений при производстве строительных, покрасочных и ремонтных работ. Спецодежда каспер для работы с краской, щелочами, кислотами, в условиях пыли, грязи и прочих нетоксичных загрязнений. Комбинезон химзащиты с капюшоном и застежкой на молнии. По низу брюк и рукавов вшита резинка. Комбинезон унисекс изготовлен из прочного нетканого материала 20 г./м2, который не позволяет впитывать влагу и притягивать частички пыли и грязи. Комбинезон имеет минимальное количество швов. В области рук, щиколоток и овала лица обеспечено плотное прилегание за счет резинок. Подходит для медицинских учреждений. Используется как медицинская форма в лабораториях, пищевой промышленности и химических производствах, во время строительных и малярных работ, ремонта и покраски автомобиля, медперсонала, работников производства.",
    price: "65 ₽ / шт",
    images: ["pic/bel/1.JPG", "pic/bel/2.JPG", "pic/bel/3.JPG", "pic/bel/4.JPG"],
  },
  {
    id: 2,
    title: "Комбинезон Каспер 25 г/м",
    description: "Костюм защитный одноразовый Каспер из ткани спанбонд для мужчин и женщин, для защиты одежды от загрязнений при производстве строительных, покрасочных и ремонтных работ. Спецодежда каспер для работы с краской, щелочами, кислотами, в условиях пыли, грязи и прочих нетоксичных загрязнений. Комбинезон химзащиты с капюшоном и застежкой на молнии. По низу брюк и рукавов вшита резинка. Комбинезон унисекс изготовлен из прочного нетканого материала 25 г./м2, который не позволяет впитывать влагу и притягивать частички пыли и грязи. Комбинезон имеет минимальное количество швов. В области рук, щиколоток и овала лица обеспечено плотное прилегание за счет резинок. Подходит для медицинских учреждений. Используется как медицинская форма в лабораториях, пищевой промышленности и химических производствах, во время строительных и малярных работ, ремонта и покраски автомобиля, медперсонала, работников производства.",
    price: "72 ₽ / шт",
    images: ["pic/bel/1.JPG", "pic/bel/2.JPG", "pic/bel/3.JPG", "pic/bel/4.JPG"],
  },
  {
    id: 3,
    title: "Комбинезон Каспер темно-синий 40 г/м",
    description: "Костюм защитный одноразовый Каспер из ткани спанбонд для мужчин и женщин, для защиты одежды от загрязнений при производстве строительных, покрасочных и ремонтных работ. Спецодежда каспер для работы с краской, щелочами, кислотами, в условиях пыли, грязи и прочих нетоксичных загрязнений. Комбинезон химзащиты с капюшоном и застежкой на молнии. По низу брюк и рукавов вшита резинка. Комбинезон унисекс изготовлен из прочного нетканого материала 40 г./м2, который не позволяет впитывать влагу и притягивать частички пыли и грязи. Комбинезон имеет минимальное количество швов. В области рук, щиколоток и овала лица обеспечено плотное прилегание за счет резинок. Подходит для медицинских учреждений. Используется как медицинская форма в лабораториях, пищевой промышленности и химических производствах, во время строительных и малярных работ, ремонта и покраски автомобиля, медперсонала, работников производства.",
    price: "95,5 ₽ / шт",
    images: ["pic/cher/1.JPG", "pic/cher/2.JPG", "pic/cher/3.JPG", "pic/cher/4.JPG"],
  },
  {
    id: 4,
    title: "Комбинезон Каспер 30 г/м",
    description: "Костюм защитный одноразовый Каспер из ткани спанбонд для мужчин и женщин, для защиты одежды от загрязнений при производстве строительных, покрасочных и ремонтных работ. Спецодежда каспер для работы с краской, щелочами, кислотами, в условиях пыли, грязи и прочих нетоксичных загрязнений. Комбинезон химзащиты с капюшоном и застежкой на молнии. По низу брюк и рукавов вшита резинка. Комбинезон унисекс изготовлен из прочного нетканого материала 30 г./м2, который не позволяет впитывать влагу и притягивать частички пыли и грязи. Комбинезон имеет минимальное количество швов. В области рук, щиколоток и овала лица обеспечено плотное прилегание за счет резинок. Подходит для медицинских учреждений. Используется как медицинская форма в лабораториях, пищевой промышленности и химических производствах, во время строительных и малярных работ, ремонта и покраски автомобиля, медперсонала, работников производства..",
    price: "79 ₽ / шт",
    images: ["pic/bel/1.JPG", "pic/bel/2.JPG", "pic/bel/3.JPG", "pic/bel/4.JPG"],
  },
  {
    id: 5,
    title: "Комбинезон Каспер ламинированный 40 г/м",
    description: "Костюм защитный ламинированный одноразовый Каспер из ткани спанбонд, плотностью 40гр/м, ламинированный ПВД 15мкр для мужчин и женщин, для защиты одежды от загрязнений при производстве строительных, покрасочных и ремонтных работ. Спецодежда Каспер для работы с краской, щелочами, кислотами, в условиях пыли, грязи и прочих нетоксичных загрязнений. Комбинезон химзащиты с капюшоном и застежкой на молнии. По низу брюк и рукавов вшита резинка. Комбинезон унисекс изготовлен из прочного нетканого материала 40 г./м2, ламинированный ПВД 15мкр, который не позволяет впитывать влагу и притягивать частички пыли и грязи. Комбинезон имеет минимальное количество швов. В области рук, щиколоток и овала лица обеспечено плотное прилегание за счет резинок. Подходит для медицинских учреждений. Используется как медицинская форма в лабораториях, пищевой промышленности и химических производствах, во время строительных и малярных работ, ремонта и покраски автомобиля, медперсонала, работников производства.",
    price: "125 ₽ / шт",
    images: ["pic/gol/gol1.JPG", "pic/gol/gol2.JPG", "pic/gol/gol3.JPG", "pic/gol/gol4.JPG"],
  },
  {
    id: 6,
    title: "Комбинезон Каспер 40 г/м",
    description: "Костюм защитный одноразовый Каспер из ткани спанбонд для мужчин и женщин, для защиты одежды от загрязнений при производстве строительных, покрасочных и ремонтных работ. Спецодежда каспер для работы с краской, щелочами, кислотами, в условиях пыли, грязи и прочих нетоксичных загрязнений. Комбинезон химзащиты с капюшоном и застежкой на молнии. По низу брюк и рукавов вшита резинка. Комбинезон унисекс изготовлен из прочного нетканого материала 40 г./м2, который не позволяет впитывать влагу и притягивать частички пыли и грязи. Комбинезон имеет минимальное количество швов. В области рук, щиколоток и овала лица обеспечено плотное прилегание за счет резинок. Подходит для медицинских учреждений. Используется как медицинская форма в лабораториях, пищевой промышленности и химических производствах, во время строительных и малярных работ, ремонта и покраски автомобиля, медперсонала, работников производства.",
    price: "92 ₽ / шт",
    images: ["pic/bel/1.JPG", "pic/bel/2.JPG", "pic/bel/3.JPG", "pic/bel/4.JPG"],
  },

  // Халаты
  {
    id: 7,
    title: "Халат белый 20 г/м",
    description: "Халат одноразовый из нетканого материала спанбонд 20гр/м на кнопках. Кроме того, халаты, изготавливаемые из спанбонда, абсолютно нетоксичны, хорошо пропускают воздух, гигроскопичны и гипоаллергенны. Одноразовый халат из спанбонда с застежками-кнопками универсален и может применяться сотрудниками медицинских учреждений, салонов красоты, пищевых предприятий. Изделие является одноразовым. Изделие нестерильное.",
    price: "42 ₽ / шт",
    images: ["pic/hbel/1.JPG", "pic/hbel/2.JPG", "pic/hbel/3.JPG", "pic/hbel/4.JPG"],
  },
  {
    id: 8,
    title: "Халат белый 25 г/м",
    description: "Халат одноразовый из нетканого материала спанбонд 25гр/м на кнопках. Кроме того, халаты, изготавливаемые из спанбонда, абсолютно нетоксичны, хорошо пропускают воздух, гигроскопичны и гипоаллергенны. Одноразовый халат из спанбонда с застежками-кнопками универсален и может применяться сотрудниками медицинских учреждений, салонов красоты, пищевых предприятий. Изделие является одноразовым. Изделие нестерильное.",
    price: "44,5 ₽ / шт",
    images: ["pic/hbel/1.JPG", "pic/hbel/2.JPG", "pic/hbel/3.JPG", "pic/hbel/4.JPG"],
  },
  {
    id: 9,
    title: "Халат белый 40 г/м",
    description: "Халат одноразовый из нетканого материала спанбонд 40гр/м на кнопках. Кроме того, халаты, изготавливаемые из спанбонда, абсолютно нетоксичны, хорошо пропускают воздух, гигроскопичны и гипоаллергенны. Одноразовый халат из спанбонда с застежками-кнопками универсален и может применяться сотрудниками медицинских учреждений, салонов красоты, пищевых предприятий. Изделие является одноразовым. Изделие нестерильное.",
    price: "47 ₽ / шт",
    images: ["pic/hbel/1.JPG", "pic/hbel/2.JPG", "pic/hbel/3.JPG", "pic/hbel/4.JPG"],
  },
  {
    id: 10,
    title: "Голубой халат 20 г/м",
    description: "Халат одноразовый из нетканого материала спанбонд 20гр/м на кнопках. Кроме того, халаты, изготавливаемые из спанбонда, абсолютно нетоксичны, хорошо пропускают воздух, гигроскопичны и гипоаллергенны. Одноразовый халат из спанбонда с застежками-кнопками универсален и может применяться сотрудниками медицинских учреждений, салонов красоты, пищевых предприятий. Изделие является одноразовым. Изделие нестерильное.",
    price: "43,5 ₽ / шт",
    images: ["pic/hgol/1.JPG", "pic/hgol/1.JPG", "pic/hgol/1.JPG", "pic/hgol/1.JPG"],
  },
  {
    id: 11,
    title: "Голубой халат 25 г/м",
    description: "Халат одноразовый из нетканого материала спанбонд 25гр/м на кнопках. Кроме того, халаты, изготавливаемые из спанбонда, абсолютно нетоксичны, хорошо пропускают воздух, гигроскопичны и гипоаллергенны. Одноразовый халат из спанбонда с застежками-кнопками универсален и может применяться сотрудниками медицинских учреждений, салонов красоты, пищевых предприятий. Изделие является одноразовым. Изделие нестерильное.",
    price: "44,5 ₽ / шт",
    images: ["pic/hgol/1.JPG", "pic/hgol/1.JPG", "pic/hgol/1.JPG", "pic/hgol/1.JPG"],
  },

  // Шапочки
  {
    id: 12,
    title: "Шапочка одноразовая",
    description: "Описание одноразовой шапочки...",
    price: "15 ₽ / шт",
    images: ["pic/shap1.webp", "pic/shap1-2.webp", "pic/shap1-3.webp", "pic/shap1-4.webp"],
  },
  {
    id: 13,
    title: "Шапочка медицинская",
    description: "Описание медицинской шапочки...",
    price: "17 ₽ / шт",
    images: ["pic/shap2.webp", "pic/shap2-2.webp", "pic/shap2-3.webp", "pic/shap2-4.webp"],
  },

  // Бахилы
  {
    id: 14,
    title: "Бахилы стандарт",
    description: "Описание стандартных бахил...",
    price: "6 ₽ / пара",
    images: ["pic/bah1.webp", "pic/bah1-2.webp", "pic/bah1-3.webp", "pic/bah1-4.webp"],
  },
  {
    id: 15,
    title: "Бахилы усиленные",
    description: "Описание усиленных бахил...",
    price: "9 ₽ / пара",
    images: ["pic/bah2.webp", "pic/bah2-2.webp", "pic/bah2-3.webp", "pic/bah2-4.webp"],
  },
];

  const urlParams = new URLSearchParams(window.location.search);
  const productId = urlParams.has("id") ? parseInt(urlParams.get("id"), 10) : null;

  let product = products.find((p) => p.id === productId) || products[0];

  if (!product) {
    document.querySelector("main").innerHTML = "<p>Товар не найден.</p>";
    return;
  }

  // Заполняем заголовок, описание, цену
  document.getElementById("product-title").textContent = product.title;
  document.getElementById("product-description").textContent = product.description;
  document.getElementById("product-price").textContent = product.price;

  // Галерея
  const gallery = document.getElementById("product-gallery");
  gallery.innerHTML = "";
  product.images.forEach((src, idx) => {
    const img = document.createElement("img");
    img.src = src;
    img.alt = `${product.title} фото ${idx + 1}`;
    img.classList.add("gallery-thumb");
    img.style.cursor = "pointer";
    img.dataset.index = idx; // для навигации в модалке
    gallery.appendChild(img);
  });
  const modal = document.getElementById("modal-gallery");
  const modalImage = document.getElementById("modal-image");
  const modalClose = document.getElementById("modal-close");
  const prevBtn = document.getElementById("prev-btn");
  const nextBtn = document.getElementById("next-btn");

  let currentIndex = 0;

  function openModal(index) {
    currentIndex = index;
    modalImage.src = product.images[currentIndex];
    modal.style.display = "flex";
  }

  function closeModal() {
    modal.style.display = "none";
  }

  function showPrev() {
    currentIndex = (currentIndex - 1 + product.images.length) % product.images.length;
    modalImage.src = product.images[currentIndex];
  }

  function showNext() {
    currentIndex = (currentIndex + 1) % product.images.length;
    modalImage.src = product.images[currentIndex];
  }

  gallery.querySelectorAll(".gallery-thumb").forEach((img) => {
    img.addEventListener("click", () => openModal(+img.dataset.index));
  });

  modalClose.addEventListener("click", closeModal);
  prevBtn.addEventListener("click", showPrev);
  nextBtn.addEventListener("click", showNext);

  modal.addEventListener("click", (e) => {
    if (e.target === modal) closeModal();
  });

  document.addEventListener("keydown", (e) => {
    if (modal.style.display === "flex") {
      if (e.key === "Escape") closeModal();
      else if (e.key === "ArrowLeft") showPrev();
      else if (e.key === "ArrowRight") showNext();
    }
  });

  const addToCartBtn = document.getElementById("add-to-cart");
  addToCartBtn.addEventListener("click", () => {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    const index = cart.findIndex((item) => item.id === product.id);

    if (index > -1) {
      cart[index].quantity++;
    } else {
      cart.push({
        id: product.id,
        title: product.title,
        price: product.price,
        quantity: 1,
      });
    }

    localStorage.setItem("cart", JSON.stringify(cart));

    const msg = document.createElement("div");
    msg.textContent = `"${product.title}" добавлен в корзину`;
    Object.assign(msg.style, {
      position: "fixed",
      bottom: "10px",
      right: "10px",
      background: "#4caf50",
      color: "white",
      padding: "10px 15px",
      borderRadius: "5px",
      zIndex: 10000,
      fontWeight: "600",
      boxShadow: "0 2px 8px rgba(0,0,0,0.2)",
      userSelect: "none",
    });
    document.body.appendChild(msg);

    setTimeout(() => {
      msg.remove();
    }, 2000);
  });
});
